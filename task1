Задание: Анализ кода на «запахи» и выбор стратегии рефакторинга
Цель:
Научиться выявлять «кодовые запахи» (code smells) в существующем коде и выбирать подходящие стратегии для их устранения.
Описание:
У вас есть фрагмент кода, который выполняет базовые операции с данными пользователей (CRUD). В коде намеренно присутствуют «запахи», такие как:
Дублирование кода
Слишком длинные функции
Нарушение принципа единственной ответственности (SRP)
Использование «магических чисел»
Смешение логики бизнес-правил и отображения
Ваша задача:
Проанализировать код и найти минимум 5 «запахов».
Для каждого запаха написать:
Тип запаха
Почему это плохо
Предложенную стратегию рефакторинга
Провести рефакторинг кода с использованием выбранных стратегий.
Пример исходного кода (Python)
users = []

def add_user(name, age, email):
    if age < 0:
        print("Возраст не может быть отрицательным")
        return
    users.append({"name": name, "age": age, "email": email})
    print("Пользователь добавлен")

def print_users():
    for u in users:
        print("Name: " + u["name"] + ", Age: " + str(u["age"]) + ", Email: " + u["email"])

def find_user_by_email(email):
    for u in users:
        if u["email"] == email:
            print("Пользователь найден: " + u["name"])
            return u
    print("Пользователь не найден")
    return None

def main():
    add_user("Alice", 25, "alice@example.com")
    add_user("Bob", -5, "bob@example.com")
    add_user("Charlie", 30, "charlie@example.com")
    print_users()
    find_user_by_email("bob@example.com")
    find_user_by_email("dave@example.com")

main()

Подсказки для анализа «запахов»:
Long Method / Large Function – функция делает слишком много.
Duplicated Code – повторяющиеся конструкции.
Magic Numbers – числа в коде без объяснения.
Feature Envy – функция слишком зависит от структуры данных.
Data Clumps – связанные данные хранятся отдельно вместо класса/структуры.
Inappropriate Intimacy – функции напрямую работают с внутренними структурами других объектов.

Что нужно сделать после анализа:
Переписать функции, разделив ответственность.
Использовать константы вместо «магических чисел».
Добавить классы для пользователя, если это улучшает структуру.
Убрать дублирование кода.
Сделать код читаемым и поддерживаемым.
